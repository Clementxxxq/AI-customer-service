# æ—¥å†åŠŸèƒ½ - å¿«é€Ÿå‚è€ƒ

## ğŸ“ ä¿®æ”¹äº†ä»€ä¹ˆæ–‡ä»¶ï¼Ÿ

### åç«¯ (3 ä¸ªæ–‡ä»¶)

| æ–‡ä»¶ | æ”¹åŠ¨ |
|------|------|
| `backend/services/availability_service.py` | âœ¨ **æ–°å¢** - æ—¶é—´æ§½ç”ŸæˆæœåŠ¡ |
| `backend/schemas/chat.py` | ğŸ“ ä¿®æ”¹ - æ·»åŠ  `AppointmentAvailability`, `TimeSlotInfo` æ¨¡å‹ |
| `backend/routes/chat.py` | ğŸ“ ä¿®æ”¹ - å¯¼å…¥ `AvailabilityService`, è¿”å› `availability` å­—æ®µ |

### å‰ç«¯ (5 ä¸ªæ–‡ä»¶)

| æ–‡ä»¶ | æ”¹åŠ¨ |
|------|------|
| `frontend/components/CalendarPicker.tsx` | âœ¨ **æ–°å¢** - æ—¥å† UI ç»„ä»¶ |
| `frontend/components/CalendarPicker.css` | âœ¨ **æ–°å¢** - æ—¥å†æ ·å¼ |
| `frontend/components/MessageList.tsx` | ğŸ“ ä¿®æ”¹ - é›†æˆæ—¥å†æ˜¾ç¤º |
| `frontend/components/DentalChat.tsx` | ğŸ“ ä¿®æ”¹ - å¤„ç†æ—¥å†é€‰æ‹© |
| `frontend/package.json` | ğŸ“ ä¿®æ”¹ - æ·»åŠ ä¾èµ– `react-day-picker`, `date-fns` |

## ğŸ”Œ API å“åº”ç¤ºä¾‹

### è¯·æ±‚
```bash
POST /api/chat/message
{
  "content": "æˆ‘æƒ³é¢„çº¦æ´—ç‰™",
  "user_id": 1,
  "conversation_id": "chat_xxx"
}
```

### å“åº”
```json
{
  "message_id": "msg_xxx",
  "user_message": "æˆ‘æƒ³é¢„çº¦æ´—ç‰™",
  "bot_response": "å¾ˆå¥½ï¼è¯·é€‰æ‹©æ‚¨å–œæ¬¢çš„æ—¥æœŸå’Œæ—¶é—´",
  "intent": "appointment",
  "availability": {
    "available_dates": [
      {
        "date": "2026-01-10",
        "day_of_week": "Friday",
        "slots": ["09:00", "09:30", "10:00", "14:00"]
      },
      {
        "date": "2026-01-11",
        "day_of_week": "Saturday",
        "slots": ["10:00", "11:00"]
      }
    ],
    "suggested": {
      "date": "2026-01-10",
      "time": "10:00"
    }
  }
}
```

## ğŸ¨ å‰ç«¯æ˜¾ç¤º

ç”¨æˆ·çœ‹åˆ°ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¾ˆå¥½ï¼è¯·é€‰æ‹©æ—¥æœŸå’Œæ—¶é—´    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“… é€‰æ‹©æ—¥æœŸ              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Jan â”‚ Jan â”‚ Jan â”‚    â”‚
â”‚  â”‚ 10  â”‚ 11  â”‚ 13  â”‚    â”‚
â”‚  â”‚ 4   â”‚ 2   â”‚ 3   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ• é€‰æ‹©æ—¶é—´              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚09:00â”‚09:30â”‚10:00â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚14:00â”‚14:30â”‚     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’¡ æ¨èæ—¶é—´: 10:00       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ æ•°æ®æµ

```
å‰ç«¯ç”¨æˆ·é€‰æ‹©: "2026-01-10" + "10:00"
        â†“
å‰ç«¯è½¬æ¢: "I'd like to book at 10:00 on 2026-01-10"
        â†“
åç«¯æ¥æ”¶: è¯†åˆ«æ—¥æœŸå’Œæ—¶é—´
        â†“
åç«¯æ‰§è¡Œ: é¢„çº¦é€»è¾‘
        â†“
è¿”å›: é¢„çº¦ç¡®è®¤
```

## âš™ï¸ åç«¯æ—¶é—´æ§½ç”Ÿæˆé€»è¾‘

```python
# ç”Ÿæˆè§„åˆ™
- å·¥ä½œæ—¶é—´: 09:00 - 18:00
- æ—¶é—´é—´éš”: 30 åˆ†é’Ÿ
- è·³è¿‡å‘¨æœ«: Saturday & Sunday
- å±•ç¤ºå¤©æ•°: 14 å¤©ï¼ˆå¯é…ç½®ï¼‰
- æ¨è: å°½é‡æ¨è 10:00ï¼Œå¦‚æœæ— æ³•æ¨èç¬¬ä¸€ä¸ªå¯ç”¨æ—¶é—´

# ç¤ºä¾‹
Mon Jan 10: 09:00, 09:30, 10:00, ..., 17:30
Tue Jan 11: 09:00, 09:30, 10:00, ..., 17:30
Wed Jan 12: (è·³è¿‡ - å·²æ»¡)
Thu Jan 13: 10:00, 10:30, 14:00, ..., 17:30
```

## ğŸ§ª æµ‹è¯•å‘½ä»¤

### æµ‹è¯•å¯ç”¨æ—¶é—´ç”Ÿæˆ
```bash
cd e:\Learning\AI-customer-service
python test_availability.py
```

### è¿è¡Œåç«¯
```bash
cd backend
python main.py
```

### è¿è¡Œå‰ç«¯
```bash
cd frontend
npm install
npm run dev
```

## ğŸ“¦ ä¾èµ–å®‰è£…

å‰ç«¯éœ€è¦æ–°ä¾èµ–ï¼š
```bash
npm install react-day-picker date-fns
```

## ğŸ¯ æ ¸å¿ƒå‡½æ•°

### åç«¯
```python
# è·å–å¯é¢„çº¦æ—¥æœŸ
available_dates = AvailabilityService.get_available_dates(
    doctor_id=1,      # å¯é€‰
    days_ahead=14     # æŸ¥çœ‹æœªæ¥ 14 å¤©
)

# è·å–æ¨èæ—¶é—´
suggested = AvailabilityService.get_suggested_appointment(available_dates)
```

### å‰ç«¯
```typescript
// ç”¨æˆ·é€‰æ‹©æ—¥æœŸå’Œæ—¶é—´
function handleSelectDateTime(date: string, time: string) {
  // è½¬æ¢ä¸ºè‡ªç„¶è¯­è¨€
  const message = `I'd like to book at ${time} on ${date}`;
  // å‘é€ç»™åç«¯
  handleSendMessage(message);
}
```

## âœ… æµ‹è¯•æ£€æŸ¥æ¸…å•

- [ ] åç«¯å¯ä»¥å¯¼å…¥ `AvailabilityService`
- [ ] `/api/chat/message` è¿”å› `availability` å­—æ®µ
- [ ] å‰ç«¯æ˜¾ç¤ºæ—¥å†ç»„ä»¶
- [ ] é€‰æ‹©æ—¥æœŸå’Œæ—¶é—´åå‘é€æ¶ˆæ¯
- [ ] åç«¯æ”¶åˆ°é¢„çº¦ç¡®è®¤è¯·æ±‚
- [ ] æ•°æ®åº“ä¿å­˜é¢„çº¦

## ğŸš¨ å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆ AI ä¸ç”Ÿæˆ HTML æ—¥å†ï¼Ÿ**
A: å› ä¸º AI åªè´Ÿè´£é€»è¾‘å’Œæ•°æ®ï¼ˆJSONï¼‰ï¼Œå‰ç«¯è´Ÿè´£ UI è¡¨ç°ã€‚è¿™æ ·æ›´çµæ´»ã€æ›´ä¸“ä¸šã€‚

**Q: å¦‚ä½•æ”¹å˜å·¥ä½œæ—¶é—´ï¼Ÿ**
A: ç¼–è¾‘ `availability_service.py` çš„ `BUSINESS_HOURS_START` å’Œ `BUSINESS_HOURS_END`

**Q: å¦‚ä½•æ”¹å˜æ—¶é—´é—´éš”ï¼Ÿ**
A: ç¼–è¾‘ `SLOT_DURATION_MINUTES = 30`ï¼ˆæ”¹ä¸º 15, 45, 60 ç­‰ï¼‰

**Q: å¦‚ä½•åªæ˜¾ç¤ºç‰¹å®šåŒ»ç”Ÿçš„å¯ç”¨æ—¶é—´ï¼Ÿ**
A: åç«¯è‡ªåŠ¨æ£€æµ‹åŒ»ç”Ÿ IDï¼Œå‰ç«¯ä¼ é€’å³å¯

## ğŸ”— ç›¸å…³æ–‡ä»¶é“¾æ¥

- [æ—¶é—´ç”ŸæˆæœåŠ¡](backend/services/availability_service.py)
- [æ•°æ®æ¨¡å‹](backend/schemas/chat.py)
- [Chat API](backend/routes/chat.py)
- [æ—¥å†ç»„ä»¶](frontend/components/CalendarPicker.tsx)
- [ä¸»èŠå¤©é¡µé¢](frontend/components/DentalChat.tsx)

---

**æ¶æ„åŸåˆ™**: AI = å¤§è„‘ï¼ˆå†³ç­–ï¼‰ï¼Œå‰ç«¯ = æ‰‹è„šï¼ˆå±•ç¤ºï¼‰ âœ¨
